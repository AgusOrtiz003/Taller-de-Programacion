programa p3p3
procesos
  proceso EnviarIds(E id:numero)
  comenzar
    EnviarMensaje(id,r1)
    EnviarMensaje((id+1),r2)
    EnviarMensaje((id+2),r3)
    EnviarMensaje((id+3),r4)
  fin
  proceso EnviarEsquina(E av:numero;E ca:numero)
  comenzar
    EnviarMensaje(av,r1)
    EnviarMensaje(av,r2)
    EnviarMensaje(av,r3)
    EnviarMensaje(av,r4)
    EnviarMensaje(ca,r1)
    EnviarMensaje(ca,r2)
    EnviarMensaje(ca,r3)
    EnviarMensaje(ca,r4)
  fin
areas
  cuadrante:AreaPC(2,2,10,10)
  area1:AreaP(2,1,2,1)
  area2:AreaP(3,1,3,1)
  area3:AreaP(4,1,4,1)
  area4:AreaP(5,1,5,1)
  areaJ:AreaP(1,1,1,1)
robots
  robot florero
  variables
    id,f,avI,caI,av,ca:numero
    listo:boolean
  comenzar
    avI:=PosAv
    caI:=PosCa
    f:=0
    listo:=F
    RecibirMensaje(id,rJ)
    RecibirMensaje(av,rJ)
    RecibirMensaje(ca,rJ)
    mientras(~listo)
      BloquearEsquina(av,ca)
      Pos(av,ca)
      si(HayFlorEnLaEsquina)
        tomarFlor
        f:=f+1
        si(~HayFlorEnLaEsquina)
          listo:=V
      sino
        listo:=V
      Pos(avI,caI)
      LiberarEsquina(av,ca)
    EnviarMensaje(id,rJ)
    EnviarMensaje(f,rJ) 
  fin
  robot jefe
  variables
    id,maxf,maxid,av,ca,f:numero
  comenzar
    maxf:=-1
    id:=1
    EnviarIds(id)
    Random(av,2,10)
    Random(ca,2,10)
    EnviarEsquina(av,ca)
    repetir 4
      RecibirMensaje(id,*)
      si(id=1)
        RecibirMensaje(f,r1)
      sino
        si(id=2)
          RecibirMensaje(f,r2)
        sino
          si(id=3)
            RecibirMensaje(f,r3)
          sino
            RecibirMensaje(f,r4)
      si(f>maxf)
        maxf:=f
        maxid:=id
    Informar('El ganador es el ',maxid)
  fin
variables
  r1,r2,r3,r4:florero
  rJ:jefe
comenzar
  AsignarArea(r1,area1)
  AsignarArea(r2,area2)
  AsignarArea(r3,area3)
  AsignarArea(r4,area4)
  AsignarArea(r1,cuadrante)
  AsignarArea(r2,cuadrante)
  AsignarArea(r3,cuadrante)
  AsignarArea(r4,cuadrante)
  AsignarArea(rJ,areaJ)
  Iniciar(r1,2,1)
  Iniciar(r2,3,1)
  Iniciar(r3,4,1)
  Iniciar(r4,5,1)
  Iniciar(rJ,1,1)
fin
